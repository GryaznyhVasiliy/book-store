# book-store
 NestJs + TypeORM RESTful web service

//Условия задачи позволяют ограничиться двумя сущностями: User и Book, так как существует лишь 1 экзэмпляр каждой книги
//Абонемент является полем "subscribe" таблицы User. Тип поля boolean, значит подписка может быть только одна
//Связь между таблицами User(OneToMany)Book. Одному пользователю может принадлежать до 5(включительно) книг 

1) Метод для добавления пользователя

	Тип: POST 
	Путь: /user/create
	Тело запроса:
	{
		    "name": string,
	    	"subscribe": boolean
	}
	Назначение: Создаёт запись о пользователе в бд
	Возвращаемое значение: Json с полями пользователя из бд
	Пример респонса:
	{
    		"name": "Vasiliy",
    		"subscribe": false,
    		"id": 5
	}

2) Метод для редактировния пользователя
	
	Тип: PUT
	Путь: /user/edit/:userId
	Тело запроса:
	{
		    "name": string,
	     "subscribe": boolean
	}
	Назначение: Изменяет существующую запись о пользователе в бд
	Возвращаемое значение: Json с полями пользователя из бд
	Пример респонса:
	{
    		"id": 1,
    		"name": "Vasiliy1",
    		"subscribe": true
	}

3) Метод для удаления пользователя

	Тип: DELETE
	Путь: /user/delete/:userId
	Тело запроса: не требуется
	Условие: Нельзя удалить пользователя, которому принадлежит хотя бы одна книга
	Назначение: Удаляет запись о пользователе из бд
	Возвращаемое значение: нет
	Пример респонса:нет

4) Метод для установки того что пользователь купил абонемент

	Тип: GET
	Путь: /user/isSub/:userId
	Тело запроса: не требуется
	Назначение: Проверяет значение subscribe пользователя в бд
	Возвращаемое значение: boolean
	Пример респонса: false

5) Метод для получения списка всех пользователей

	Тип: GET
	Путь: /user/all
	Тело запроса: не требуется
	Назначение: Возвращает список с записями о пользователях из бд
	Возвращаемое значение: Json со списком пользователей
	Пример респонса:
	[
    		{
        		"id": 5,
        		"name": "Vasiliy4",
        		"subscribe": false
    		},
    		{
        		"id": 1,
        		"name": "Vasiliy1",
        		"subscribe": true
    		}
	]

6) Метод для получения конкретного пользователя (информация по пользователю
+ список взятых книг)
	
	Тип: GET
	Путь: /user/id/:userId
	Тело запроса: не требуется
	Назначение: Возвращает информацию о пользователе и список имеющихся книг
	Возвращаемое значение: Json с записью о пользователе и списком имеющихся книг
	Пример респонса:
	{
    		"id": 1,
    		"name": "Vasiliy1",
    		"subscribe": true,
    		"books": [
        	{
            		"id": 1,
            		"name": "book1"
        	},
        	{
            		"id": 2,
            		"name": "Book2"
        	}]
	}

7) Метод для добавления книги

	Тип: POST
	Путь: /book/create
	Тело запроса:
	{
		"name": string
	}
	Назначение: Добавляет запись о книге в бд
	Возвращаемое значение: Json с информацией о книге из бд
	Пример респонса:
	{
		"name": "book",
    		"id": 10
	}

8) Метод для добавления книги к пользователю (когда выдаем книгу пользователю)

	Тип: PUT
	Путь: /book/order/:bookId
	Тело запроса: 
	{
		"owner": integer
	}
	Назначение: Добавляет в поле ownerId книги значение поля id пользователя
	Условие: У одного пользователя может быть до 5 книг
	Возвращаемое значение: Json с обновленной информацией о книге
	Пример респонса:
	{
		"id": 6,
    		"name": "book",
    		"owner": 5
	}

9) Метод для "возвращения книги" (когда пользователь отдает книгу обратно)

	Тип: PUT
	Путь: /book/order/:bookId
	Тело запроса:
	{
		    "owner": integer
	}
	Назначение: Удаляет из поля ownerId книги значение поля id пользователя
	Условие: Пользователь должен обладать книгой
	Возвращаемое значение: Json с обновленной информацией о книге
	Пример респонса:
	{
    		"id": 3,
    		"name": "book3",
    		"owner": null
	}
